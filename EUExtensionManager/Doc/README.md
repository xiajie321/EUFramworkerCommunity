# EU 拓展管理器

统一管理 EUFramework 框架所有拓展插件的工具。

## 功能特性

### 已安装管理
- 查看所有本地安装的拓展列表
- 实时显示已安装数量
- 显示版本更新提示 (Update 徽章)
- 支持查看文档、定位文件夹、卸载等操作
- 自动扫描 Assets、Packages 及核心目录下的拓展

### 社区仓库
- 浏览远程社区仓库中的所有可用拓展
- 基于 GitHub API 获取实时列表
- 显示已安装状态 (Installed 徽章)
- 一键下载安装新拓展 (支持 ZIP 下载与解压)
- 智能目录匹配 (支持文件夹名与扩展名不一致的情况)
- 本地与内存双重缓存机制，提升加载速度 (缓存有效期 5 分钟)

### 版本管理
- 自动检测可更新的拓展
- 显示版本对比 (本地版本 -> 远程版本)
- 一键更新到最新版本
- 智能增量更新检测

### 依赖管理
- 显示拓展的依赖项列表
- 绿色标签表示已安装的依赖
- 红色标签表示未安装，点击可直接下载
- 支持自动下载外部 GitHub 仓库依赖到指定目录
- 支持递归解析并安装依赖链 (自动处理多层级依赖)
- 智能版本检查，确保依赖满足最低版本要求

### 核心框架支持
- 自动识别核心框架组件 (Category 为 "框架" 或 "Core" 的拓展)
- 支持将核心组件安装到独立的核心路径
- 核心路径下的组件也会被识别为特殊的本地拓展

### 搜索与筛选
- 支持按名称、包名、描述搜索
- 支持按分类 (Category) 筛选列表
- 支持按名称或状态排序列表

### 安全与迁移
- 安全安装模式：同步文件内容而非简单覆盖，自动清理目标目录中的冗余文件 (保留 .meta 文件)
- 路径迁移功能：在设置中修改安装路径时，支持自动将旧路径下的扩展迁移到新位置

## 使用方法

### 打开管理器
菜单栏：**EUFramework -> 拓展管理器**

### 界面说明

#### 左侧边栏
- **已安装**：查看本地已安装的拓展 (显示数量)
- **社区仓库**：浏览远程可用的拓展 (显示数量)
- **设置**：配置仓库地址和安装路径

#### 主内容区
- **顶部**：标题、搜索框、筛选器 (分类/排序)、刷新按钮
- **左侧列表**：拓展列表，带动态颜色图标、名称、版本、描述
- **右侧详情**：选中拓展的详细信息、依赖列表和操作按钮

### 操作按钮
| 按钮 | 说明 |
| --- | --- |
| 安装 | 从社区仓库下载并安装拓展 |
| 更新 | 更新到最新版本 (有新版时显示) |
| 文档 | 打开拓展的文档文件 (优先打开 README.md) |
| 定位 | 在文件管理器中打开拓展目录 |
| 卸载 | 删除拓展 (需确认，管理器自身不可卸载) |

## 设置选项

### 社区仓库地址
默认：`https://github.com/xiajie321/EUFramworkerCommunity`

支持 GitHub 仓库地址，用于获取拓展列表。管理器通过 GitHub API 读取仓库内容。

### 插件安装路径
默认：`Assets/EUFramework/Extension`

普通拓展插件的默认安装位置。修改此路径时，管理器会询问是否迁移现有拓展。

### 核心安装路径
默认：`Assets/EUFramework/Core`

核心框架组件的默认安装位置。

### 重置设置
支持一键恢复所有设置为默认值。

## 创建自己的拓展

每个拓展需要在根目录包含 `extension.json` 文件：

```json
{
  "name": "com.yourname.extension-name",
  "displayName": "拓展显示名称",
  "version": "1.0.0",
  "description": "拓展描述",
  "author": "作者名称",
  "category": "分类名称",
  "dependencies": [
    {
      "name": "com.eu.core",
      "gitUrl": "https://github.com/user/repo",
      "installPath": "Assets/EUFramework/Core",
      "version": "1.0.0"
    }
  ]
}
```

### 字段说明

| 字段 | 必需 | 说明 |
| --- | --- | --- |
| name | 是 | 唯一标识符，建议使用反向域名格式 |
| displayName | 是 | 显示在列表中的名称 |
| version | 是 | 版本号，格式：主版本.次版本.修订版本 |
| description | 是 | 简短描述 |
| author | 否 | 作者名称 |
| category | 否 | 分类。若设为 "框架"，默认安装到核心路径；否则安装到插件路径 |
| dependencies | 否 | 依赖列表，包含 name, gitUrl, installPath, version |

### 依赖项配置详解

`dependencies` 数组中的每个对象可以包含以下字段：

- **name**: 依赖项的包名 (必需)。
- **gitUrl**: 依赖项所在的 GitHub 仓库地址 (可选)。
  - 如果提供，将直接从该 URL 下载 ZIP 安装。
  - 如果留空，管理器会尝试在社区仓库中查找同名拓展。
- **version**: 依赖项的最低版本要求 (可选)。
  - 如果本地已安装的版本低于此版本，管理器会提示更新。
- **installPath**: 依赖项的安装路径 (可选)。
  - 支持 `Assets/...` 和 `Packages/...` 路径。
  - 如果指定了路径，将安装到该路径。
  - 如果留空，根据依赖包的 `category` 决定安装位置。

### 推荐目录结构

```
YourExtension/
├── extension.json      # 必需：拓展描述文件
├── Script/             # C# 脚本
├── ConfigPanel/        # UI 样式文件
├── Doc/                # 文档目录
│   └── README.md       # 使用说明
└── Example/            # 示例
    ├── Scenes/
    └── Script/
```

## 发布到社区仓库

1. Fork 社区仓库
2. 在根目录创建你的拓展文件夹
3. 确保包含 `extension.json`
4. 提交 Pull Request

## 常见问题

**Q: 为什么刷新列表很慢？**
A: 首次加载需要请求 GitHub API，受网络环境影响。后续加载会使用本地缓存 (5分钟有效)，速度会很快。

**Q: 如何手动安装拓展？**
A: 将拓展文件夹复制到项目的 `Assets/EUFramework/Extension` (或你设置的路径) 下，点击管理器刷新按钮即可。

**Q: 依赖安装失败怎么办？**
A: 检查网络连接，或手动下载依赖包并放置到指定目录。管理器会自动识别已手动安装的依赖。
